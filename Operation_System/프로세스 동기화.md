# 프로세스 동기화

## 프로세스 동기화란?

답변 - 동시에 실행되고 있는 프로세스나 스레드가 공유 리소스를 가지고 있을 때, 서로 간섭하지 않도록 운영체제가 순서를 조정하는 기능입니다. 이런 기능이 없다면, 경쟁 상태나 교착 상태 등의 문제를 방지할 수 있습니다.

1. 경쟁 상태란 무엇인가요?

   여러 프로세스들이 동시에 공유 데이터에 접근하는 상황에서, 어떤 순서로 데이터에 접근하느냐에 따라 결과 값이 달라질 수 있는 상황입니다. 이는 데이터의 불일치 문제를 발생시킬 수 있습니다.

   경쟁 상태를 막고, 데이터의 일관성을 유지하기 위해서는 프로세스 간의 실행 순서를 정해주는 동기화 메커니즘이 필요합니다.
   <br>

2. 임계 구역에 대해

   임계 구역이란 코드 상에서 공유 데이터에 접근하는 부분, 즉, 경쟁 상태가 발생할 수 있는 부분입니다.

   이를 해결하기 위해서는 3개의 조건인 상호 배제, progress, 한정 대기가 지켜져야합니다.

   상호배제는 하나의 임계 구역에 하나의 프로세스만 접근해야합니다.

   progress 조건은 작업 중인 프로세스가 없다면 진입하고자하는 다른 프로세스가 존재한다면 진입할 수 있어야 합니다.

   한정 대기는 임계 구역에 진입하려는 프로세스가 무한정 기다리지 않도록하는 것입니다.

   이를 해결하기 위해서는 Mutex Lock이나 semaphores를 사용할 수 있습니다.
   <br>

3. Mutex Lock

   이미 하나의 프로세스가 임계 구역에서 작업 중이면 다른 프로세스들은 임계구역에 들어갈 수 없도록 하는 기술입니다. SW 적으로 해결할 수 있는 가장 간단한 방법이지만, Busy Waiting이라는 단점이 존재합니다.
   <br>

   **Busy Waiting이란**
   <br>

   spin lock이라고도 불리는 Busy Waiting은 임계 구역에 프로세스가 존재할 때, 다른 프로세스들은 임계 구역에 계속해서 진입하려고 시도하기 때문에 CPU를 낭비하게 됩니다.

   lock이 풀릴 때까지 lock의 상태를 계속 확인합니다. 멀티 프로세서 시스템에서는 임계 구역에 진입하기 위한 대기시간이 짧은 편이기에, 종종 사용합니다.
   <br>

4. Semaphores

   세마포어는 여러 프로세스가 임계 구역에 진입할 수 있는 신호 메커니즘에 기반한 기술입니다. 카운터를 이용하여 동시에 자원에 접근할 수 있는 프로세스를 제한하고, 프로세스나 스레드는 임계 구역에 들어가기 위해 권한을 요청합니다. 사용 가능한 임계 구역이 있다면 권한을 부여합니다. 사용 가능한 임계 구역이 없다면, 세마포어는 프로세스가 완료할 때까지 권한을 요청한 프로세스를 기다리게 하지 않게끔 block시킵니다. 이후, 임계 구역의 프로세스가 작업을 끝내기를 기다렸다가 block된 프로세스의 block을 해제하고 권한을 부여합니다.
   <br>

   세마포어의 종류로는 카운터의 범위가 제한이 없는 카운팅 세마포어와 0, 1의 값만 가질 수 있는 binary 세마포어가 있습니다.
   <br>

   1. binary 세마포어와 Mutex Lock의 차이

      카운팅 세마포어와는 다르게 하나의 임계 구역에 하나의 프로세스만 진입할 수 있습니다. 이는 Mutex Lock처럼 동작하지만, 다른 점이 있습니다. Mutex Lock에서 진입을 결정하는 Mutex 객체는 프로세스나 스레드가 소유하기에, 객체 소유자가 Mutex를 해제할 수 있습니다. 하지만, binary 세마포어는 프로세스나 스레드가 이런 소유권이 없기에, 다른 프로세스가 세마포어를 잠그고 해제할 수 있습니다.
